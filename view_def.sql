CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `student_reports` AS select `s`.`student_id` AS `student_id`,`s`.`name` AS `name`,`d`.`dept_name` AS `branch`,`s`.`division` AS `division`,coalesce(sum(`m`.`total`),0) AS `total_marks_obtained`,(count(`m`.`mark_id`) * 100) AS `max_possible_marks`,(case when (count(`m`.`mark_id`) > 0) then ((coalesce(sum(`m`.`total`),0) / (count(`m`.`mark_id`) * 100)) * 100) else 0 end) AS `percentage`,(select ((sum((case when (`attendance`.`status` = 'Present') then 1 else 0 end)) / count(0)) * 100) from `attendance` where ((`attendance`.`student_id` = `s`.`student_id`) and (`attendance`.`status` is not null))) AS `attendance_percentage` from ((`student` `s` left join `marks` `m` on((`s`.`student_id` = `m`.`student_id`))) left join `department` `d` on((`s`.`dept_id` = `d`.`dept_id`))) group by `s`.`student_id`,`s`.`name`,`d`.`dept_name`,`s`.`division`